<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>BSTBlox 2019 Style - Refined</title>
<style>
  body { font-family: Arial, sans-serif; margin: 0; background: #f0f4f8; }
  /* Fixed Navbar */
  #navbar {
    display: none; background-color: #0a7dda; color: white;
    padding: 10px 20px; font-weight: bold; position: sticky; top: 0; z-index: 1000;
  }
  #navbar ul { margin: 0; padding: 0; list-style: none; display: inline-block; }
  #navbar ul li { display: inline-block; margin-right: 15px; cursor: pointer; transition: 0.2s; }
  #navbar ul li:hover { color: #c2e1ff; text-decoration: underline; }
  #logoutBtn { float: right; background-color: #095c9d; border: none; color: white; padding: 6px 12px; cursor: pointer; border-radius: 3px; }
  
  /* Modernized View Containers */
  .view { max-width: 800px; margin: 40px auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); display: none; }
  .view.active { display: block; }
  input { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
  .actionBtn { width: 100%; background-color: #0a7dda; color: white; border: none; padding: 14px; cursor: pointer; border-radius: 4px; font-weight: bold; }
  .error { color: #d93025; font-size: 14px; margin-top: 5px; height: 20px; }
</style>
</head>
<body>

<div id="navbar">
  <span id="welcomeUser"></span>
  <ul id="navLinks">
    <li onclick="showPage('home')">Home</li>
    <li onclick="showPage('games')">Games</li>
    <li onclick="showPage('avatar')">Avatar</li>
    <li onclick="showPage('catalog')">Catalog</li>
  </ul>
  <button id="logoutBtn" onclick="logout()">Logout</button>
</div>

<!-- Views -->
<div id="loginView" class="view">
  <h2>Login to BSTBlox</h2>
  <input id="loginUser" type="text" placeholder="Username" autocomplete="username" />
  <input id="loginPass" type="password" placeholder="Password" autocomplete="current-password" />
  <button class="actionBtn" onclick="login()">Log In</button>
  <p style="text-align:center; color:#0a7dda; cursor:pointer;" onclick="showView('signupView')">New here? Create account</p>
  <div id="loginError" class="error"></div>
</div>

<div id="signupView" class="view">
  <h2>Create Account</h2>
  <input id="signupUser" type="text" placeholder="Choose Username" />
  <input id="signupPass" type="password" placeholder="Choose Password" />
  <button class="actionBtn" onclick="signup()">Sign Up</button>
  <p style="text-align:center; color:#0a7dda; cursor:pointer;" onclick="showView('loginView')">Back to Login</p>
  <div id="signupError" class="error"></div>
</div>

<div id="home" class="view"><h1>Dashboard</h1><p>Welcome back! Check out latest updates from 2025.</p></div>
<div id="games" class="view"><h1>Games</h1><p>Explore community creations.</p></div>
<div id="avatar" class="view"><h1>Avatar Editor</h1><p>Customize your look.</p></div>
<div id="catalog" class="view"><h1>Catalog</h1><p>Shop for new items.</p></div>

<script>
  // Robust LocalStorage Management
  const storage = {
    getUsers: () => JSON.parse(localStorage.getItem('bstblox_users') || '{}'),
    saveUsers: (u) => localStorage.setItem('bstblox_users', JSON.stringify(u)),
    setCurrent: (n) => localStorage.setItem('bstblox_session', n),
    getCurrent: () => localStorage.getItem('bstblox_session')
  };

  function showView(id) {
    document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
    const target = document.getElementById(id);
    if(target) target.classList.add('active');
    document.querySelectorAll('.error').forEach(e => e.textContent = '');
  }

  function signup() {
    const u = document.getElementById('signupUser').value.trim();
    const p = document.getElementById('signupPass').value;
    const err = document.getElementById('signupError');

    if (u.length < 3) return err.textContent = 'Username too short.';
    const users = storage.getUsers();
    if (users[u]) return err.textContent = 'User already exists.';

    users[u] = p;
    storage.saveUsers(users);
    loginSuccess(u);
  }

  function login() {
    const u = document.getElementById('loginUser').value.trim();
    const p = document.getElementById('loginPass').value;
    const users = storage.getUsers();

    if (users[u] && users[u] === p) {
      loginSuccess(u);
    } else {
      document.getElementById('loginError').textContent = 'Invalid credentials.';
    }
  }

  function loginSuccess(username) {
    storage.setCurrent(username);
    document.getElementById('welcomeUser').textContent = `Hello, ${username} | `;
    document.getElementById('navbar').style.display = 'block';
    showView('home');
  }

  function logout() {
    localStorage.removeItem('bstblox_session');
    document.getElementById('navbar').style.display = 'none';
    showView('loginView');
  }

  function showPage(page) { showView(page); }

  window.onload = () => {
    const session = storage.getCurrent();
    session ? loginSuccess(session) : showView('loginView');
  };
</script>
</body>
</html>
